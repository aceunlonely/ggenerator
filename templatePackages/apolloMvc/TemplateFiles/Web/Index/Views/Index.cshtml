@model %NameSpace%Web.Areas.%MVC-MODULE%.Models.%ClassName%IndexModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm())
{
    <div class="row" id="search-wrapper">
        <div class="col-sm-12">
            <section class="panel">
                <header class="panel-heading">
                    @Html.Raw(Model.SitePath)
                    <span class="tools pull-right btn-sm">
                        <a class="fa fa-chevron-down" href="javascript:;"></a>
                    </span>
                    <button type="button" id="btnSearch" class="btn btn01 pull-right btn-sm">查询</button>
                </header>
                <div class="panel-body">
                    <!-- 查询条件 -->
                    <table class="searchTable">
                       %MVC-HTML-Condition%
                    </table>
                </div>
            </section>
        </div>
    </div>
    <div class="row" id="toolbar-wrapper">
        <div class="col-sm-12">
            <section class="panel panel-toolbar">
                <header class="panel-heading eait-block">
                    <div class="eait-area">
                        <button type="button" id="btnAdd" class="btn btn02 color01" title="新增"><span class="fa fa-plus"></span><b class="icon-txt">新增</b></button>
                        <button type="button" id="btnDeleteAll" class="btn btn02 color07" title="批量删除"><span class="fa fa-trash-o"></span><b class="icon-txt">批量删除</b></button>
						 %MVC_HTMLIMPORTLABEL%
						 %MVC_HTMLEXPORTLABEL%
						 %MVC_HTMLSYNCIMPORTLABEL%
						 %MVC_HTMLSYNCEXPORTLABEL%
                    </div>
                </header>
            </section>
        </div>
    </div>
    <div id="grid-wrapper" class="row">
        <div class="col-sm-12">
            <section class="panel">
                <div class="panel-body">
                    <div id="gridContainer">
                        <table id="gridTable" data-toggle="table" data-escape="true" class="table table-striped table-hover" data-id-field="Oid" get-data="@Url.Content("~/" + SystemConfig.SystemAreaKey + "/%MVC-MODULE%/%ClassName%/LoadIndexData")">
                            <thead>
                                <tr>
                                    <th data-checkbox="true"></th>
                                    <th data-formatter="operatorFormatter" data-width="90px"></th>
                                    %MVC-HTML-Show%

                                </tr>
                            </thead>
                        </table>
                    </div>
                    @{
                        Html.RenderPartial("~/Views/Common/Paginate.cshtml", Model.SearchEntity);
                    }
                </div>
            </section>
        </div>
    </div>
                        }

@section head{
    <script type="text/javascript">
        $(function() {
            //弹出新增界面
            $("#btnAdd").click(function() {
                var id = 10;
                var options = {
                    url: '@Url.Content("~/" + @SystemConfig.SystemAreaKey + "/%MVC-MODULE%/%ClassName%/%MVC-EDIT%")',
                    title: "新增",
                    width: 800,
                    height: 500
                };
                apolloPage.framework.base.openNewDialog(options);
            });

            //删除
            $("#btnDeleteAll").click(function() {
                if (apolloPage.isSelect()) {
                    apolloPage.framework.base.systemConfirm("确定要删除勾选的这几条数据？", function () {
                        var oids = apolloPage.listSelectedValues();
                        $.ajax({
                            url: "@Url.Content("~/" + @SystemConfig.SystemAreaKey + "/%MVC-MODULE%/%ClassName%/DeleteAll")",
                        type: "post",
                        data: { oids: oids.join(',') },
                        dataType: "json",
                        success: function (result) {
                            if (result.Success) {
                                apolloPage.framework.base.systemAlert("删除成功");
                            } else {
                                apolloPage.framework.base.systemAlert("删除失败");
                            }
                            apolloPage.framework.base.tabs.refresh();
                        }
                    });
                });
            }
            });
			
			%MVC_HTMLIMPORTJS%
		
			%MVC_HTMLEXPORTJS%
			
			%MVC_HTMLSYNCIMPORTJS%
        });
		
		
		 //修改
    function btnUpdate_click(oid) {
        var options = {
            url: '@Url.Content("~/" + SystemConfig.SystemAreaKey + "/%MVC-MODULE%/%ClassName%/%MVC-EDIT%?ID=")' + oid,
            title: "维护",
            width: 800
        };
        apolloPage.framework.base.openNewDialog(options);
    }
    //单个删除
    function btnDelete_click(oid) {
        apolloPage.framework.base.systemConfirm("确认要删除该条记录吗？", function () {
            $.ajax({
                url: "@Url.Content("~/" + @SystemConfig.SystemAreaKey + "/%MVC-MODULE%/%ClassName%/Delete")",
                type: "post",
                data: { oid: oid },
                dataType: "json",
                success: function (result) {
                    if (result.Success) {
                        apolloPage.framework.base.systemAlert("删除成功");
                    } else {
                        apolloPage.framework.base.systemAlert("删除失败");
                    }
                    apolloPage.framework.base.tabs.refresh();
                }
            });
        });
    }
      
        function operatorFormatter(value, row, index) {
        return '<button type="button" class="btn btn02 color03" onclick="btnUpdate_click(\'' + row.Oid + '\')" title="修改" id="btnUpdate"><span class="fa fa-pencil-square-o"></span></button>' +
            '<button type="button" class="btn btn02 color07" onclick="btnDelete_click(\'' + row.Oid + '\')" title="删除" id="btnDelete"><span class="fa fa-trash-o"></span></button>';
    }
    </script>
}
